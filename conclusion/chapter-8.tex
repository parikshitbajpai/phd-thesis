\chapter{Conclusions} \label{chap:conclusions}

	Equilibrium thermodynamics provides the thermodynamic properties and driving forces for a wide variety of phenomena in nuclear reactors and a new equilibirium solver called {\GEM} has been developed. {\GEM} has been developed with the goal of enabling direct coupling of thermodynamic equilibrium calculations in multiphysics simulations performed using the Multiphysics Object Oriented Simulation Environment (MOOSE). Incorporating equilibrium calculations in multiphysics simulations comes with several challenges many of which are related to the existing software infrastructure. Though the most substantial contribution of this work is the creation of the software from ground up, several additional contributions were made to the field. First, while several algorithms from the literature are used, their implementation has a significant impact on the computational performance and this work had to be cognisant of this fact. The algorithms in the literature were modified to reflect the evolution in computing architectures. Second, despite model and database development being relatively mature, it was realised that knowledge gaps exist in the understanding of many models, such as the modified quasichemical model (MQM) and this work helped in improving the understanding of such models. Third, there is often a lack of understanding about the algorithms, their capabilities and limitations, and the interpretation of the results from equilibrium thermodynamics softwares and, through this work, an effort was made to clarify some these choices. Lastly, despite years of research into global optimisation algorithms, a majority of current equilibrium codes use a rather simplistic sampling approach that often leads to failure in converge or inaccurate results. This work used an approach based on numerical experiments to quantitatively compare some promising global optimisation approaches in terms of their applicability to the phase equilibria problem. 

	The development of the code was motivated by the need for a modelling tool for molten salt corrosion. Modelling corrosion requires understanding of the microstructure for which the phase field model is often used. The phase field model, in turn, requires several thermodynamic quantities which must be computed through an optimisation algorithm. Coupling with the phase field module of MOOSE was the primary goal for developing this code and the code must be able to handle several thermodynamic models used to describe such systems. The model most widely used for the molten salts is the Modified Quasichemical Model in Quadruplet Approximation (MQMQA) which wasn't very well understood previously. As part of this work, the MQMQA was analysed to get a better understanding and the chemical potential expressions were derived and published. Derivation of chemical potentials for non-ideal models is not trivial and most papers in open literature don't describe the models in sufficient details let alone giving the expressions of chemical potentials which can be implemented into code by software developers. The chemical potentials for some commonly used excess mixing models were shown in Chapter~\ref{chap:thermo}.
	
	Calculation of thermodynamic equilibrium is based on the fundamental laws of thermodynamics and several algorithms already reported in the literature were used to satisfy the necessary and sufficient conditions described in Chapter~\ref{chap:equilibrium}. The levelling method was used for initialisation followed by the full non-linear solution through the method of Lagrange multipliers. There are several factors that can impact the performance of the solver and the implementation of the code had to account for these factors. In doing so, the implementations were optimised to offer flexibility in terms of the system size, models that can be used, convergence criteria and others. Though the code cannot be presented herein due to export control restrictions, the algorithms used in the development were described in Chapter~\ref{chap:implementation} through flowcharts and the reasoning behind main design decisions were also justified. A major challenge in satisfying the sufficient condition of thermodynamic equilibrium is the need for global optimisation algorithms. This condition requires that the driving force of all metastable phases be positive but the driving force function is often non-convex for non-ideal models and ensuring that the driving force is indeed positive is not a straightforward task. Despite major advances in global optimisation methods, the applications to thermodynamic equilibrium have been few and are mostly limited to very simple problems such as vapour-liquid equilibrium. As part of this dissertation, significant effort was spent on performance considerations of global optimisation algorithms. The spatial branch \& bound (sBB) bound algorithm was experimentally compared with an adaptive particle swarm optimisation (APSO) to prove their applicability to the equilibrium problems. It was shown that compared to the often used grid sampling, both the selected algorithms show a higher reliability to cost ratio. While sBB had the highest reliability, it came at a computational cost. On the other hand, APSO showed a great compromise between cost and reliability and though it failed to converge a few times, it was usually noticeably faster than sBB. Since both algorithms have their pros and cons, justifying the choice of implementation depends on the application and therefore both the algorithms were implemented with the choice left to the end-user. Valuable insights into the performance of global optimisation algorithms was thus obtained and can help inform the decision of not only end-users but also of other developers.
	
	Though the work was aimed at developing capabilities rather than performing predictive calculations, several examples of potential applications were shown through demonstrations in Chapter~\ref{chap:results}. A simple coupling between the phase field and GEM code show how the fidelity of corrosion models may improve by adding equilibrium calculations. Moreover, the code will be a valuable tool in modelling other physical processes and in particular will be useful in source-term analyses and material modelling under non-normal operating conditions of nuclear reactors. To instil confidence in the accuracy of results predicted by the code, the results of {\GEM} were compared to the commercial code FactSage and excellent agreement was observed.
	
	In summary, the software developed as part of this work adds native thermodynamic equilibrium capability to the multiphysics simulation framework MOOSE. It would enable direct coupling of phase equilibrium calculations with other multiphysics codes in the MOOSE environment and allow modelling and simulation of complex physical phenomena helping in design and discovery of nuclear materials and help expedite the deployment of advanced reactors, in particular the molten salt reactor. The dissertation also addresses several knowledge gaps and concerns in the field of thermodynamic equilibrium modelling with the most significant being a better understanding of the MQMQA and a rigorous experimental comparison of methods for global optimisation applied to phase equilibrium calculations.
	
	
	